#! /usr/bin/perl
use strict;my($t,$m,@s,@r,@v,%d);sub p{print@_}sub t{substr(shift,0,4)}
sub R{my$i=shift;\$i}sub nxt{($1=~/^(\d+)/&&push@s,$1)||(exists$d{t($1)}
?$d{t($1)}->($_[0]):p"?")while${$_[0]}=~/(\S+)/g}@r=(qw{>if(!X=D;CifX>=D
word!pZjoin("Z",keys%d,"") /mod!X=U;U=int(X/T);T=X%T swap!X=D;$m=D;PX,$m
:!${$_[0]}=~/(\\S+)\\s([^;]*);/g;$d{t($1)}=eval"sub{nxtZRZq;$2;}" -1!P-1
emit!pZchrZD ."!O/\G\s([^"]*)"/g;p$1 !!$m=D;$v[$m]=D >r!push@r,D and!U&M
r>!Ppop@r bye!exit @!T=$v[T] if(!D||C xor!U^M (.)!pZD dup!PT +!U+M *!U*M
drop!D or!U|M (!C )! els(! )els!C});my%t=(Z=>"",qw{P push@s, D pop@s
O ${$_[0]}=~ C O/\)/g T $s[-1] U $s[-2] X $t M =T;D});for(@r){0 while
s/([ZPDOCTUXM])/$t{$1} /g;/^(.[^!]*)!(.*)$/; $d{$1}=eval"sub{$2}"}@r=();
nxt(\$_)while<>
